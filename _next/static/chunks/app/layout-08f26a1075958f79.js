(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{642:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var a=r(8045),l=r(7482),s=r(4429),o=r.n(s),n=r(5177);let i=new Map;function d(e){let{name:t}=e,[r,l]=(0,n.useState)([]),[s,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(null),m=(0,n.useRef)(null),h=(0,n.useRef)("");return((0,n.useEffect)(()=>{var e;let r=t.trim();if(!r){l([]),u(null);return}if(r.length<2){l([]),u("请输入至少 2 个字符");return}if(r===h.current)return;let a=i.get(r),s=Date.now();if(a&&s-a.ts<6e4){l(a.items),u(null);return}d(!0),u(null),null==(e=m.current)||e.abort();let o=new AbortController;m.current=o;let n=setTimeout(async()=>{try{let e=await fetch("/api/blog-search?q=".concat(encodeURIComponent(r),"&limit=10"),{signal:o.signal});if(!e.ok)throw Error("HTTP ".concat(e.status));let t=await e.json();i.set(r,{ts:Date.now(),items:t.items}),h.current=r,l(t.items)}catch(e){if((null==e?void 0:e.name)==="AbortError")return;console.error("搜索失败:",e),u("搜索失败，请稍后重试"),l([])}finally{d(!1)}},250);return()=>{clearTimeout(n),o.abort()}},[t]),s)?(0,a.jsxs)("div",{className:"p-4 text-center",children:[(0,a.jsx)("div",{className:"inline-block w-4 h-4 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"搜索中..."})]}):c?(0,a.jsx)("div",{className:"p-4 text-center text-red-500 dark:text-red-400",children:c}):0===r.length&&t.trim().length>=2?(0,a.jsx)("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"未找到相关内容"}):(0,a.jsx)("div",{className:"py-2",role:"listbox","aria-label":"博客搜索建议",children:r.map(e=>(0,a.jsxs)(o(),{href:e.path,className:"flex items-start gap-3 px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200 border-b border-gray-100 dark:border-gray-700 last:border-b-0",role:"option",children:[e.image?(0,a.jsx)("img",{src:e.image,alt:"",className:"w-10 h-10 rounded object-cover bg-gray-200 dark:bg-gray-600"}):(0,a.jsx)("div",{className:"w-10 h-10 rounded bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-[10px] text-gray-500 uppercase",children:e.type.replace("_"," ")}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white truncate",children:e.title}),e.snippet&&(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2",children:e.snippet}),(0,a.jsx)("div",{className:"mt-1 text-xs text-gray-400",children:e.path})]})]},e.id))})}let c={limit:10,sortBy:"time",order:"desc"};function u(){let[e,t]=(0,n.useState)("light");(0,n.useEffect)(()=>{let e=localStorage.getItem("theme")||"light";t(e),document.documentElement.classList.toggle("dark","dark"===e)},[]);let[r,s]=(0,n.useState)(""),[i,u]=(0,n.useState)([{name:"首页",path:"/"},{name:"文章",path:"/article",child:[]},{name:"二次元",path:"/acg",child:[{name:"动漫",path:"/acg/anime"},{name:"漫画",path:"/acg/comic"},{name:"轻小说",path:"/acg/lightnovel"}]},{name:"聊天",path:"/chat"},{name:"关于",path:"/about"}]);return(0,n.useEffect)(()=>{let{limit:e,sortBy:t,order:r}=c,a=new URLSearchParams({limit:String(e),sortBy:t,order:r}).toString();fetch("/api/articles?".concat(a)).then(e=>e.json()).then(e=>{let t=((null==e?void 0:e.items)||[]).map(e=>({name:e.title,path:e.path}));u(e=>e.map(e=>"文章"===e.name?{...e,child:t}:e))}).catch(()=>{})},[]),(0,a.jsxs)("div",{className:"flex justify-between h-20 border-box items-center p-4 pl-60 pr-60 bg-white/90 backdrop-blur-md border-b border-gray-200/50 fixed top-0 left-0 right-0 z-50 dark:bg-slate-900/90 dark:border-slate-700/50 transition-all duration-300 shadow-sm dark:shadow-slate-900/20",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("img",{src:"https://picgo-elaina.oss-cn-chengdu.aliyuncs.com/typora/202509091206701.png","data-no-zoom":!0,alt:"logo",className:"w-16 h-16 border-box rounded-full"})}),(0,a.jsxs)("div",{className:"relative flex items-center w-100 mx-auto",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)("input",{type:"text",value:r,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&console.log("搜索内容:",r)},placeholder:"Search articles...",className:"w-full h-12 pl-12 pr-4 text-sm font-medium placeholder-gray-500 border border-gray-200/80 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white/80 hover:bg-white transition-all duration-300 dark:bg-slate-800/80 dark:border-slate-600/50 dark:placeholder-gray-400 dark:text-white dark:hover:bg-slate-800 dark:focus:ring-blue-400 backdrop-blur-sm"}),(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4",children:(0,a.jsx)(l.A,{className:"w-5 h-5 text-gray-400 dark:text-gray-500"})}),r&&(0,a.jsx)("button",{onClick:()=>s(""),title:"清除搜索",className:"absolute inset-y-0 right-0 flex items-center pr-4 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 transition-colors duration-200",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 z-50",children:(0,a.jsx)("div",{className:"bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl shadow-2xl border border-gray-200/50 dark:border-slate-600/30 max-h-96 overflow-y-auto",children:(0,a.jsx)(d,{name:r})})})]}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("ul",{className:"flex items-center",children:i.map(e=>(0,a.jsxs)("li",{className:"ml-6 relative group",children:[(0,a.jsxs)(o(),{href:e.path,className:"flex items-center gap-1 text-slate-700 hover:text-blue-600 transition-all duration-300 dark:text-slate-200 dark:hover:text-blue-400 py-2 px-3 rounded-lg hover:bg-white/60 dark:hover:bg-slate-700/60 font-medium",children:[e.name,e.child&&(0,a.jsx)("svg",{className:"w-4 h-4 ml-1 transform transition-transform duration-200 group-hover:rotate-180",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e.child&&(0,a.jsx)("ul",{className:"absolute top-full left-0 min-w-36 bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-lg shadow-xl border border-gray-200/50 dark:border-slate-600/30 py-2 z-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transform translate-y-2 group-hover:translate-y-0 transition-all duration-300",children:e.child.map(e=>(0,a.jsx)("li",{children:(0,a.jsx)(o(),{href:e.path,className:"block px-4 py-2 text-slate-700 dark:text-slate-200 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-white/60 dark:hover:bg-slate-700/60 transition-all duration-200 text-sm rounded-md mx-1",children:e.name})},e.path))})]},e.path))})}),(0,a.jsx)("button",{onClick:()=>(function(){let r="light"===e?"dark":"light";t(r),localStorage.setItem("theme",r),document.documentElement.classList.toggle("dark","dark"===r)})(),className:"ml-6 p-2 rounded-lg bg-white/60 hover:bg-white/80 border border-gray-200/50 transition-all duration-300 dark:bg-slate-700/60 dark:hover:bg-slate-600/80 dark:border-slate-600/30 flex justify-center items-center shadow-sm hover:shadow backdrop-blur-sm",children:(0,a.jsx)("span",{className:"text-xl",children:"light"===e?"\uD83C\uDF19":"\uD83C\uDF1E"})})]})}},3390:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});var a=r(8045),l=r(5177),s=r(4380);function o(e){let{selector:t="img",background:r="rgba(0,0,0,.84)"}=e,[o,n]=(0,l.useState)(null),[i,d]=(0,l.useState)(!1),c=(0,l.useRef)(0);return((0,l.useEffect)(()=>d(!0),[]),(0,l.useEffect)(()=>{let e=e=>{var r;if(!(e.target instanceof Element))return;let a=e.target.closest(t);if(a&&void 0===a.dataset.noZoom)e.target.closest("a")&&e.preventDefault(),n({src:a.currentSrc||a.src,alt:null!=(r=a.alt)?r:""}),e.stopPropagation()};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[t]),(0,l.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n(null)};return o?(c.current=window.scrollY,document.body.style.position="fixed",document.body.style.top="-".concat(c.current,"px"),document.body.style.width="100%",document.addEventListener("keydown",e)):(document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,c.current),document.removeEventListener("keydown",e)),()=>document.removeEventListener("keydown",e)},[o]),i&&o)?(0,s.createPortal)((0,a.jsxs)("div",{role:"dialog","aria-modal":!0,onClick:()=>n(null),style:{position:"fixed",inset:0,background:r,backdropFilter:"blur(2px)",display:"flex",alignItems:"center",justifyContent:"center",padding:"5vw",cursor:"zoom-out",zIndex:9999,transition:"opacity .18s ease"},children:[(0,a.jsx)("img",{src:o.src,alt:o.alt,onClick:e=>e.stopPropagation(),style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",borderRadius:12,boxShadow:"0 10px 40px rgba(0,0,0,.5)",userSelect:"none"},draggable:!1}),(0,a.jsx)("button",{onClick:()=>n(null),"aria-label":"Close image",style:{position:"fixed",top:16,right:16,fontSize:12,padding:"8px 12px",borderRadius:12,background:"rgba(0,0,0,.6)",color:"#fff",border:0,cursor:"pointer"},children:"Esc 关闭"})]}),document.body):null}},5483:()=>{},6172:(e,t,r)=>{Promise.resolve().then(r.bind(r,8833)),Promise.resolve().then(r.t.bind(r,3730,23)),Promise.resolve().then(r.bind(r,3390)),Promise.resolve().then(r.bind(r,642)),Promise.resolve().then(r.t.bind(r,5483,23))}},e=>{e.O(0,[750,730,429,639,18,986,143,358],()=>e(e.s=6172)),_N_E=e.O()}]);